---

- name: Generate PKCS#12 certificate.
  community.crypto.openssl_pkcs12:
    action: export
    path: "{{ _acme_cf_files_dir }}/{{ domain }}.p12"
    friendly_name: "{{ domain }}"
    privatekey_path: "{{ _acme_cf_files_dir }}/{{ domain }}.private.key"
    certificate_path: "{{ _acme_cf_files_dir }}/{{ domain }}.fullchain.crt"
    state: present

- name: Debug the PKCS#12 certificate file location.
  ansible.builtin.debug:
    msg:
      - "Cert file: {{ _acme_cf_files_dir }}/{{ domain }}.p12"
      - "Fullchain cert file: {{ _acme_cf_files_dir }}/{{ domain }}.fullchain.crt"
  tags: [debug]
